@startuml
title Audio Pipeline - Router Centralizado

start
:YOLO detections + depth map;
if (detections?) then (sí)
  :Coordinator ordena navigation_objects;
  if (top.priority >= umbral) then (sí)
    :Construye mensaje + metadata (prioridad, zona, cooldown);
    :Coordinator -> NavigationAudioRouter.enqueue_from_rgb(metadata);
  endif
endif

:SLAM workers producen eventos;
if (nuevos eventos) then (sí)
  :Coordinator._submit_and_route;
  :NavigationAudioRouter.enqueue_from_slam(evento);
endif

:NavigationAudioRouter evalúa cooldown global + por fuente con metadata;
if (evento aprobado?) then (sí)
  :NavigationAudioRouter ajusta cooldown en AudioSystem;
  :AudioSystem.speak_async(mensaje);
endif
:NavigationAudioRouter registra métrica/log en audio_telemetry.jsonl;
stop
@enduml
